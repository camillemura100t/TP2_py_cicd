# TP Python / Git / Web Services / CI - GROUPE 8

## Installation des environnements

### Installation environnement Nexus
* Aller sur https://github.com/camillemura100t/py_cicd/tree/main/environment/nexus et télécharger les fichiers vagrantfile et install.sh dans un dossier sur votre machine en local
* Ouvrir un terminal qui pointe sur ce dossier
* Taper "vagrant up"
* Attendre la fin de l'installation et noter le mot de passe par défaut du compte Nexus admin qui doit apparaitre à la fin du log d'installation
* Taper "vagrant ssh" et renseigner le mot de passe vagrant par défaut (= vagrant)
* Attendu : "vagrant@vagrant:~$" en prompt
* *manquant : paramétrer un hostname pour le serveur Nexus*
* Ouvrir un navigateur et aller sur http://192.168.0.101:8086/ - Il se peut que le serveur mette quelques minutes à démarrer
* Cliquer sur "Sign in" et renseigner "admin" pour le Username et le mot de passe récupéré précédemment pour le Password
* *manquant : décrire l'install par défaut de Nexus*

### Installation environnement Jenkins
* Aller sur https://github.com/camillemura100t/py_cicd/tree/main/environment/jenkins et télécharger les fichiers vagrantfile et install.sh dans un dossier sur votre machine en local
* Ouvrir un terminal qui pointe sur ce dossier
* Taper "vagrant up"
* Attendre la fin de l'installation et noter le mot de passe admin de déverouillage de Jenkins qui doit apparaitre à la fin du log d'installation
* Taper "vagrant ssh" et renseigner le mot de passe vagrant par défaut (= vagrant)
* Attendu : "vagrant@vagrant:~$" en prompt
* *manquant : paramétrer un hostname pour le serveur Jenkins*
* Ouvrir un navigateur et aller sur http://192.168.0.102:8087/
* Renseigner le mot de passe admin Jenkins récupéré précédemment pour déverouiller Jenkins
* Cliquer sur "Installer les plugins suggérés"
* Une fois tous les plugins installés, cliquer sur suivant
* Remplir les champs demandés pour créer un utilisateur admin Jenkins, cliquer sur suivant
* Cliquer sur "Commencer à utiliser Jenkins"
* *manquant : install gradle, ajout job, appel git/gradle, webhook relay etc...*

#### Configurer le plugin Gradle

* Depuis le tableau de bord, cliquer sur "Administrer Jenkins"
* Cliquer sur "System Configuration / Configuration globale des outils"
* Dans la section Gradle, cliquer sur "Installations Gradle"
* Ajouter un installateur (from Gradle.org) en le nommant et en précisant la version à utiliser (ici 7.0.1)
* Ne pas oublier d'enregistrer

#### Configurer un item

* Cliquer sur "Nouveau Item"
* Le nommer et choisir "Construire un projet free-style" et cliquer sur OK

* Aller sur l'onglet "Gestion de code source" et cliquer sur Git
* Renseigner l'url du dépôt Git à utiliser
* Laisser Credentials sur aucun
* Dans "Branches to build", taper la branche à utiliser (dans notre cas, */main)

* Aller sur l'onglet "Build"
* Cliquer sur "Ajouter..."
* Cliquer sur "Invoke Gradle script"
* Choisir la version de Gradle précédemment ajoutée
* Taper manuellement la tâche Gradle à appeler (ex: task up)

* Ne pas oublier d'enregistrer

#### Mettre en place et utiliser un Webhook

* *à documenter*

### Installation environnement Dev
* Aller sur https://github.com/camillemura100t/py_cicd/tree/main/environment/dev et télécharger les fichiers vagrantfile et install.sh dans un dossier sur votre machine en local
* Ouvrir un terminal qui pointe sur ce dossier
* Taper "vagrant up"
* Attendre la fin de l'installation
* Taper "vagrant ssh" et renseigner le mot de passe vagrant par défaut (= vagrant)
* Attendu : "vagrant@vagrant:~$" en prompt
* *manquant : paramétrer un hostname pour le serveur de dev*

## Vérification et utilisation des environnements
  
### Utilisation environnement Nexus

1. Vérification firewall
  * Taper dans l'invite de commande "sudo ufw status verbose"
  * La mention "Status : active" doit être présente
  * Les ports 22 et 8086 doivent être ouverts

### Utilisation environnement Jenkins

1. Vérification firewall
  * Taper dans l'invite de commande "sudo ufw status verbose"
  * La mention "Status : active" doit être présente
  * Les ports 22 et 8086 doivent être ouverts

### Utilisation environnement de dev

1. Vérification installation de python, flask, gradle
  * Taper dans l'invite de commande "python --version"
  * Taper dans l'invite de commande "flask --version"
  * Taper dans l'invite de commande "gradle --version"


